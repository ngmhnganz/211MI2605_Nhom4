<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Giỏ hàng của bạn</title>
    <script src="../lib/jQuery.js" type="text/javascript"></script>
    <script src="../script/toast.js" type="text/javascript"></script>
    <script src="../data/firebase-config.js" type="text/javascript"></script>
    <link rel="stylesheet" href="../css/giohang.css" type="text/css"/>
    <link rel="stylesheet" href="/css/grid_system.css">
    <link rel="stylesheet" href="/css/toast.css">
    <link rel="stylesheet" href="../css/constant.css" type="text/css"/>
    <link rel="stylesheet" href="../assets/font/fontawesome-free-5.15.4-web/css/all.min.css">

</head>
<body class="background-secondary-color">
    
    <div id="header">
        <script>$("#header").load("/component/header.html"); </script>
    </div>
    <div id="toast"></div>
    <div id="confirm_delete">
        
    </div>
    <div class="grid wide">
        
        <div class="cart-page">
            
            <div class="row">
                <div class="col l-12 m-12 c-12">
                    <div class="product">

                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col l-7 m-12 c-12 checkout-info">
                    <div class="info-container">
                        <div class="checkout-tilte">
                            Thông tin người nhận
                        </div>
                        <div class="checkout-input">
                            <input type="text" name="customerName" id="customerName" placeholder="Tên người nhận">
                            <input type="text" name="customerPhone" id="customerPhone" placeholder="Số điện thoại người nhận">
                            <input type="text" name="customerAdd" id="customerAdd" placeholder="Địa chỉ người nhận">
                        </div>
                    </div>
                        
                   
                </div>
                <div class="col l-5 m-12 c-12 checkout-info">
                        <div class="info-container">
                            <div class="checkout-tilte">
                                Phương thức thanh toán
                            </div>
                            <div class="checkout-radio">
                                <label for="cash">
                                <input type="radio" name="payment-method" id="cash" value="cash">Thanh toán bằng tiền mặt</label>
                                <label for="zalo">
                                <input type="radio" name="payment-method" id="zalo" value="zalo">Thanh toán bằng zalo</label>
                            </div>
                        </div>
                </div>
            </div>

            <div class="row">
                <div class="col c-12 m-12 l-12">
                    <div class="total-price">
                        
                    </div>
                </div>
                <div class="col c-12 m-12 l-12">
                    <div class="button-section">
                        <button class="hide" id="btnSaveCart">Lưu giỏ hàng</button>
                        <button id="btnPayment">Thanh toán</button>
                    </div>
                </div>
            </div>
           
        </div>
    </div>

    <script src="../script/giohang.js" async type="module"></script>
    
    <script>
        let discount = 5000
        let shippingFee = 10000
        function setData() {
            $('#btnSaveCart').removeClass('hide')
        }

        function calculateTotal(id){
            var price = $("#productPrice_value"+id).text().split(',').join('');
            var qty=document.getElementById("productQty"+id).value;
            if (qty==="0"){
                document.getElementById("productQty"+id).value='1'
                qty="1"
            }

            var total = parseFloat(price) *  parseFloat(qty);

            $("#totalCost"+id).text(numberWithCommas(total)+ " VNĐ");
            var sumTotal = $('.totalCost_payment').text().split(',').join('').split(' VNĐ')
            sumTotal[sumTotal.length-1]="0"

            
            var result = sumTotal.reduce( (a,b)=> parseFloat(a)+parseFloat(b));
            $('#checkout_sum').text(numberWithCommas(result)+" đ")
            $('#checkout_total_payment').text(numberWithCommas(result-discount+shippingFee)+" đ")

            setData()
        }


        function delItem(){
            //delete item in cart
        }
        function addQty(id){
            //thêm số lượng khi nhấn dấu cộng
            var qty= parseFloat(document.getElementById("productQty"+id).value);
            document.getElementById("productQty"+id).value=qty+1;
            calculateTotal(id)
            
        }
        function minusQty(id){
            var qty=parseFloat(document.getElementById("productQty"+id).value);
            var classname = document.getElementById('productQty'+id).parentNode.parentElement.attributes.class.value;
            if(qty<2){
            
            }else{
            document.getElementById("productQty"+id).value=qty-1;
            calculateTotal(id)
            }
        }

        function numberWithCommas(x) {
            return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        }
        
    </script>
</body>
</html>